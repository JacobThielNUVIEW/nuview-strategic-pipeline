<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>NUVIEW Opp Board - Strategic Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { 
            --nuview-red: #EE3338; 
            --nuview-navy: #001F3F; 
            --nuview-blue: #007BFF; 
            --nuview-gray: #6c757d;
            --nuview-light-gray: #e9ecef;
            --nuview-dark-gray: #495057;
            --dark: #212529;
            --responsive-margin: 20px;
        }
        body { 
            font-family: 'Inter', sans-serif; 
            background: linear-gradient(180deg, #f8f9fa 0%, #ffffff 100%); 
            color: var(--dark); 
            margin: 0; 
            padding: 0; 
        }
        .header { 
            background: linear-gradient(135deg, var(--nuview-navy) 0%, var(--nuview-blue) 100%); 
            color: white; 
            padding: 2.5rem 0; 
            text-align: center; 
            border-bottom: 5px solid var(--nuview-red); 
            box-shadow: 0 4px 20px rgba(0,0,0,0.15); 
            position: relative;
        }
        .header-logo {
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
            background: linear-gradient(90deg, #ffffff 0%, var(--nuview-red) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .header-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-top: 0.5rem;
        }
        .header-actions {
            margin-top: 1.5rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .header-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, var(--nuview-red) 0%, #c82630 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            box-shadow: 0 4px 12px rgba(238, 51, 56, 0.3);
        }
        .header-btn:hover {
            background: linear-gradient(135deg, #c82630 0%, var(--nuview-red) 100%);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(238, 51, 56, 0.5);
            border-color: white;
            color: white;
        }
        .header-btn:active {
            transform: translateY(-1px);
        }
        .header-btn.secondary {
            background: linear-gradient(135deg, var(--nuview-blue) 0%, #0056b3 100%);
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
        }
        .header-btn.secondary:hover {
            background: linear-gradient(135deg, #0056b3 0%, var(--nuview-blue) 100%);
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.5);
        }
        .sidebar { 
            position: fixed; 
            left: 0; 
            top: 0; 
            height: 100%; 
            width: 260px; 
            background: linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%); 
            box-shadow: 2px 0 12px rgba(0,0,0,0.08); 
            z-index: 100; 
            border-right: 3px solid var(--nuview-red); 
            padding-top: 2rem; 
            overflow-y: auto; 
        }
        .sidebar a { 
            color: var(--nuview-navy); 
            text-decoration: none; 
            display: block; 
            padding: 0.75rem 1.25rem; 
            margin: 0.25rem 0.5rem; 
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        .sidebar a:hover { 
            background: linear-gradient(90deg, rgba(238, 51, 56, 0.1) 0%, rgba(0, 123, 255, 0.1) 100%); 
            color: var(--nuview-red); 
            border-left: 4px solid var(--nuview-red); 
            padding-left: 1rem;
            transform: translateX(4px);
        }
        .sidebar a.active { 
            background: linear-gradient(90deg, var(--nuview-red) 0%, var(--nuview-blue) 100%); 
            color: white; 
            border-left: 4px solid var(--nuview-navy); 
            font-weight: 600;
        }
        .main-content { 
            margin-left: 260px; 
            margin-right: 320px;
            padding: 30px; 
            min-height: 100vh; 
        }
        .launched-opps-box {
            position: fixed;
            right: var(--responsive-margin);
            top: var(--responsive-margin);
            width: 280px;
            max-height: calc(100vh - 40px);
            background: linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            border: 2px solid var(--nuview-red);
            z-index: 90;
            overflow-y: auto;
            transition: all 0.3s ease;
        }
        .launched-opps-box:hover {
            box-shadow: 0 12px 32px rgba(0,0,0,0.2);
            transform: translateY(-2px);
        }
        .launched-opps-box h3 {
            color: var(--nuview-navy);
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--nuview-red);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .launched-opp-item {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 4px solid var(--nuview-blue);
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            transition: all 0.2s ease;
        }
        .launched-opp-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
            transform: translateX(-3px);
            border-left-color: var(--nuview-red);
        }
        .launched-opp-item h4 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--nuview-navy);
            margin-bottom: 0.5rem;
        }
        .launched-opp-item p {
            font-size: 0.8rem;
            color: var(--nuview-gray);
            margin: 0.25rem 0;
        }
        .launched-opp-value {
            font-weight: 700;
            color: var(--nuview-red);
            font-size: 0.95rem;
        }
        .launched-opps-empty {
            text-align: center;
            color: var(--nuview-gray);
            font-style: italic;
            padding: 2rem 0;
        }
        .launched-opp-link {
            color: var(--nuview-red);
            font-weight: 600;
            text-decoration: underline;
        }
        .launched-opp-link:hover {
            color: var(--nuview-navy);
        }
        .section { 
            background: linear-gradient(180deg, #ffffff 0%, #f8f9fa 100%); 
            border-radius: 16px; 
            padding: 2rem; 
            margin: 2rem 0; 
            box-shadow: 0 8px 24px rgba(0,0,0,0.1); 
            border: 1px solid var(--nuview-light-gray);
            transition: all 0.3s ease;
        }
        .section:hover {
            box-shadow: 0 12px 32px rgba(0,0,0,0.12);
            transform: translateY(-2px);
        }
        .section h2 { 
            color: var(--nuview-navy); 
            border-bottom: 4px solid var(--nuview-red); 
            padding-bottom: 0.75rem; 
            margin-bottom: 1.5rem; 
            font-size: 1.75rem; 
            font-weight: 700;
        }
        @supports (background-clip: text) or (-webkit-background-clip: text) {
            .section h2 {
                background: linear-gradient(90deg, var(--nuview-navy) 0%, var(--nuview-blue) 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }
        }
        
        /* Top 10 Opportunity Matrix Styles */
        .matrix-table { 
            width: 100%; 
            border-collapse: separate; 
            border-spacing: 0; 
            margin-top: 1.5rem;
            overflow: hidden;
            border-radius: 12px;
        }
        .matrix-table thead th { 
            background: linear-gradient(135deg, var(--nuview-navy) 0%, var(--nuview-blue) 100%); 
            color: white; 
            padding: 1rem; 
            text-align: left; 
            font-weight: 600;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 3px solid var(--nuview-red);
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .matrix-table thead th:first-child { border-top-left-radius: 12px; }
        .matrix-table thead th:last-child { border-top-right-radius: 12px; }
        .matrix-table tbody tr { 
            transition: all 0.2s ease;
            background: white;
        }
        .matrix-table tbody tr:nth-child(odd) { 
            background: linear-gradient(90deg, #ffffff 0%, #f8f9fa 100%); 
        }
        .matrix-table tbody tr:hover { 
            background: linear-gradient(90deg, rgba(238, 51, 56, 0.08) 0%, rgba(0, 123, 255, 0.08) 100%);
            transform: scale(1.01);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        .matrix-table tbody td { 
            padding: 1rem; 
            border-bottom: 1px solid var(--nuview-light-gray);
            color: var(--dark);
            font-size: 0.9rem;
        }
        .matrix-table tbody td:first-child { font-weight: 600; color: var(--nuview-navy); }
        .matrix-rank { 
            width: 50px; 
            text-align: center; 
            font-weight: 700; 
            font-size: 1.1rem;
            color: var(--nuview-red);
            background: linear-gradient(135deg, rgba(238, 51, 56, 0.1) 0%, rgba(0, 123, 255, 0.1) 100%);
        }
        .matrix-value { 
            font-weight: 700; 
            color: var(--nuview-red);
            font-size: 1.05rem;
        }
        .matrix-link { 
            text-align: center;
        }
        .matrix-link-btn { 
            display: inline-block;
            padding: 0.5rem 1rem; 
            background: linear-gradient(135deg, var(--nuview-red) 0%, #c82630 100%);
            color: white; 
            text-decoration: none; 
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .matrix-link-btn:hover { 
            background: linear-gradient(135deg, #c82630 0%, var(--nuview-red) 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(238, 51, 56, 0.4);
            border-color: var(--nuview-navy);
        }
        .matrix-link-btn:focus {
            outline: 3px solid rgba(0, 123, 255, 0.5);
            outline-offset: 2px;
        }
        .matrix-source-badge {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            background: linear-gradient(135deg, var(--nuview-gray) 0%, var(--nuview-dark-gray) 100%);
            color: white;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 0.5rem;
            transition: all 0.2s ease;
        }
        .matrix-source-badge:hover {
            background: linear-gradient(135deg, var(--nuview-dark-gray) 0%, var(--nuview-gray) 100%);
            transform: scale(1.05);
        }
        
        .search-container { 
            padding: 1.25rem; 
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); 
            margin: 1.5rem 0; 
            border-radius: 12px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
            border: 1px solid var(--nuview-light-gray);
        }
        .search-input { 
            width: 100%; 
            padding: 0.875rem; 
            border: 2px solid var(--nuview-gray); 
            border-radius: 10px; 
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }
        .search-input:focus {
            outline: none;
            border-color: var(--nuview-red);
            box-shadow: 0 0 0 3px rgba(238, 51, 56, 0.1);
        }
        .program-card { 
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); 
            border-radius: 12px; 
            padding: 1.5rem; 
            margin-bottom: 1.25rem; 
            border-left: 5px solid var(--nuview-red); 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
            transition: all 0.3s ease;
            border: 1px solid var(--nuview-light-gray);
        }
        .program-card:hover { 
            box-shadow: 0 8px 24px rgba(0,0,0,0.15); 
            transform: translateY(-4px); 
            border-left-color: var(--nuview-navy);
            background: linear-gradient(135deg, #ffffff 0%, rgba(0, 123, 255, 0.05) 100%);
        }
        .program-card.hidden { display: none; }
        .urgency-badge { display: inline-block; padding: 0.25rem 0.75rem; border-radius: 12px; font-size: 0.85rem; font-weight: 600; }
        .urgency-urgent { background: var(--nuview-red); color: white; }
        .urgency-near { background: #ffc107; color: #333; }
        .urgency-future { background: #28a745; color: white; }
        
        /* Pipeline Diagram Styles */
        .pipeline-diagram-container { width: 100%; overflow-x: auto; padding: 1rem 0; }
        .pipeline-svg { width: 100%; height: auto; min-width: 800px; }
        .pipeline-stage { cursor: pointer; transition: all 0.3s ease; }
        .pipeline-stage:hover rect { filter: url(#stageShadow) brightness(1.05); }
        .pipeline-stage:hover text { fill: var(--nuview-blue); }
        .pipeline-arrow { animation: flowAnimation 2s ease-in-out infinite; }
        @keyframes flowAnimation {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        /* Tooltip Styles */
        .pipeline-tooltip { position: absolute; background: var(--nuview-navy); color: white; padding: 0.75rem 1rem; border-radius: 8px; font-size: 0.9rem; pointer-events: none; opacity: 0; transition: opacity 0.3s ease; z-index: 1000; box-shadow: 0 4px 12px rgba(0,0,0,0.3); max-width: 280px; border: 2px solid var(--nuview-red); }
        .pipeline-tooltip::after { content: ''; position: absolute; top: 100%; left: 50%; margin-left: -6px; border: 6px solid transparent; border-top-color: var(--nuview-red); }
        .pipeline-tooltip.show { opacity: 1; }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .main-content {
                margin-right: 20px;
            }
            .launched-opps-box {
                width: 260px;
            }
        }
        @media (max-width: 992px) {
            .main-content {
                margin-left: 260px;
                margin-right: var(--responsive-margin);
            }
            .launched-opps-box {
                position: relative;
                right: auto;
                top: auto;
                width: 100%;
                max-height: none;
                margin-bottom: 2rem;
            }
            .header-actions {
                flex-direction: column;
                align-items: center;
            }
            .header-btn {
                width: 90%;
                justify-content: center;
            }
        }
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            .main-content {
                margin-left: 200px;
            }
            .pipeline-svg { 
                min-width: 600px; 
            }
            .pipeline-legend { 
                font-size: 0.85rem; 
            }
            .matrix-table {
                font-size: 0.85rem;
            }
            .matrix-table thead th,
            .matrix-table tbody td {
                padding: 0.75rem 0.5rem;
            }
        }
        @media (max-width: 576px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                border-right: none;
                border-bottom: 3px solid var(--nuview-red);
            }
            .main-content {
                margin-left: 0;
                padding: 15px;
            }
            .header {
                padding: 1.5rem 1rem;
            }
            .header-logo {
                font-size: 1.8rem;
            }
            .section {
                padding: 1.25rem;
                margin: 1rem 0;
            }
            .section h2 {
                font-size: 1.4rem;
            }
            .header-btn {
                width: 100%;
                font-size: 0.9rem;
                padding: 0.65rem 1.25rem;
            }
        }
    </style>
</head>
<body>

<nav class="sidebar">
    <h3 style="padding-left:1rem; color:var(--nuview-navy); font-weight:800;">NUVIEW INTEL</h3>
    <a href="#overview" class="active"><i class="bi bi-house-door"></i> Overview</a>
    <a href="#top-opportunities"><i class="bi bi-trophy"></i> Top 10 Matrix</a>
    <a href="#funding"><i class="bi bi-currency-dollar"></i> Funding</a>
    <a href="#lidar"><i class="bi bi-radar"></i> LiDAR</a>
    <a href="#space-systems"><i class="bi bi-rocket-takeoff"></i> Space Systems</a>
    <a href="#platform"><i class="bi bi-server"></i> Platform</a>
    <a href="pipeline.html"><i class="bi bi-funnel"></i> Pipeline Dashboard</a>
    <a href="pipeline_matrix.html"><i class="bi bi-diagram-3"></i> Pipeline Matrix</a>
</nav>

<main class="main-content" role="main">
    <header class="header" role="banner">
        <div class="header-content">
            <div class="header-logo" aria-label="NUVIEW logo">NUVIEW</div>
            <h1>NUVIEW Opp Board</h1>
            <p class="header-subtitle">Global Budget & Workflow Data ‚Ä¢ Strategic Pipeline ‚Ä¢ Agencies Worldwide</p>
            <div class="header-actions">
                <a href="#top-opportunities" class="header-btn">
                    <i class="bi bi-trophy"></i>
                    View Top Opportunities
                </a>
                <a href="pipeline.html" class="header-btn secondary">
                    <i class="bi bi-funnel"></i>
                    Pipeline Dashboard
                </a>
                <a href="pipeline_matrix.html" class="header-btn secondary">
                    <i class="bi bi-diagram-3"></i>
                    Pipeline Matrix
                </a>
            </div>
        </div>
    </header>

    <!-- Launched Opportunities Fixed Box -->
    <aside class="launched-opps-box" role="complementary" aria-label="Launched Opportunities">
        <h3>
            <i class="bi bi-rocket-takeoff-fill"></i>
            Launched Opps
        </h3>
        <div id="launched-opps-container">
            <div class="launched-opps-empty">
                Loading launched opportunities...
            </div>
        </div>
    </aside>

    <!-- Section 2: How It Works -->
    <!-- 
        LIDAR-ENABLED SERVICES & MAPPING METADATA:
        This section visualizes the core pipeline for LIDAR data processing and opportunity tracking.
        The board integrates mapping metadata that is both visually accessible through the interface
        and layered on interactive parsing forms for enhanced workflow management.
        
        ASSUMPTIONS ABOUT BUDGET DATA:
        - All budget numbers presented have sufficient archived-history framework
        - Data is structured for rapid dissemination across organizations and software circle apps
        - Historical tracking enables trend analysis and forecasting for strategic planning
        
        FUTURE WORKFLOW INTEGRATION CONCEPTS:
        - Dashboard designed to connect with live SharePoint via Office365 for sales deck collaboration
        - Supports connected edit-primary feeds for real-time data synchronization
        - Architected to integrate with Zoomed Global Version-Agents and Super Integrative CRM models
        - Enables automated workflows for opportunity management and team coordination
    -->
    <div class="section" style="margin-top: 2rem;">
        <h2><i class="bi bi-diagram-3"></i> How It Works</h2>
        <p style="color: #666; margin-bottom: 2rem;">Our intelligent pipeline processes global opportunities through multiple stages to deliver actionable intelligence.</p>
        
        <div class="pipeline-diagram-container">
            <svg viewBox="0 0 1200 300" xmlns="http://www.w3.org/2000/svg" class="pipeline-svg">
                <!-- Definitions for gradients and filters -->
                <defs>
                    <linearGradient id="stageGradient1" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#f8f9fa;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#e9ecef;stop-opacity:1" />
                    </linearGradient>
                    <linearGradient id="stageGradient2" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#f1f3f5;stop-opacity:1" />
                    </linearGradient>
                    <filter id="stageShadow">
                        <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.15"/>
                    </filter>
                    <linearGradient id="redAccent" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:#EE3338;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#d62d32;stop-opacity:1" />
                    </linearGradient>
                </defs>
                
                <!-- Stage 1: Data Sources -->
                <g class="pipeline-stage" data-stage="sources">
                    <rect x="30" y="80" width="220" height="140" rx="12" fill="url(#stageGradient1)" stroke="#001F3F" stroke-width="3" filter="url(#stageShadow)"/>
                    <rect x="30" y="80" width="220" height="8" rx="12" fill="url(#redAccent)"/>
                    <text x="140" y="115" text-anchor="middle" font-size="18" font-weight="700" fill="#001F3F">Data Sources</text>
                    <text x="140" y="145" text-anchor="middle" font-size="12" fill="#495057">Federal Contracts</text>
                    <text x="140" y="165" text-anchor="middle" font-size="12" fill="#495057">Research Programs</text>
                    <text x="140" y="185" text-anchor="middle" font-size="12" fill="#495057">Market Intelligence</text>
                    <text x="140" y="205" text-anchor="middle" font-size="12" fill="#495057">Industry Reports</text>
                    <circle cx="140" cy="55" r="20" fill="#EE3338" opacity="0.1"/>
                    <text x="140" y="62" text-anchor="middle" font-size="20" fill="#EE3338">üìä</text>
                </g>
                
                <!-- Arrow 1 -->
                <g class="pipeline-arrow">
                    <line x1="250" y1="150" x2="290" y2="150" stroke="#007BFF" stroke-width="4"/>
                    <polygon points="290,150 280,145 280,155" fill="#007BFF"/>
                </g>
                
                <!-- Stage 2: Engine -->
                <g class="pipeline-stage" data-stage="engine">
                    <rect x="310" y="80" width="220" height="140" rx="12" fill="url(#stageGradient2)" stroke="#001F3F" stroke-width="3" filter="url(#stageShadow)"/>
                    <rect x="310" y="80" width="220" height="8" rx="12" fill="url(#redAccent)"/>
                    <text x="420" y="115" text-anchor="middle" font-size="18" font-weight="700" fill="#001F3F">Processing Engine</text>
                    <text x="420" y="145" text-anchor="middle" font-size="12" fill="#495057">Data Aggregation</text>
                    <text x="420" y="165" text-anchor="middle" font-size="12" fill="#495057">Normalization</text>
                    <text x="420" y="185" text-anchor="middle" font-size="12" fill="#495057">Entity Matching</text>
                    <text x="420" y="205" text-anchor="middle" font-size="12" fill="#495057">Deduplication</text>
                    <circle cx="420" cy="55" r="20" fill="#007BFF" opacity="0.1"/>
                    <text x="420" y="62" text-anchor="middle" font-size="20" fill="#007BFF">‚öôÔ∏è</text>
                </g>
                
                <!-- Arrow 2 -->
                <g class="pipeline-arrow">
                    <line x1="530" y1="150" x2="570" y2="150" stroke="#007BFF" stroke-width="4"/>
                    <polygon points="570,150 560,145 560,155" fill="#007BFF"/>
                </g>
                
                <!-- Stage 3: Scoring -->
                <g class="pipeline-stage" data-stage="scoring">
                    <rect x="590" y="80" width="220" height="140" rx="12" fill="url(#stageGradient1)" stroke="#001F3F" stroke-width="3" filter="url(#stageShadow)"/>
                    <rect x="590" y="80" width="220" height="8" rx="12" fill="url(#redAccent)"/>
                    <text x="700" y="115" text-anchor="middle" font-size="18" font-weight="700" fill="#001F3F">Scoring System</text>
                    <text x="700" y="145" text-anchor="middle" font-size="12" fill="#495057">Value Assessment</text>
                    <text x="700" y="165" text-anchor="middle" font-size="12" fill="#495057">Urgency Analysis</text>
                    <text x="700" y="185" text-anchor="middle" font-size="12" fill="#495057">Strategic Fit</text>
                    <text x="700" y="205" text-anchor="middle" font-size="12" fill="#495057">Risk Evaluation</text>
                    <circle cx="700" cy="55" r="20" fill="#EE3338" opacity="0.1"/>
                    <text x="700" y="62" text-anchor="middle" font-size="20" fill="#EE3338">üéØ</text>
                </g>
                
                <!-- Arrow 3 -->
                <g class="pipeline-arrow">
                    <line x1="810" y1="150" x2="850" y2="150" stroke="#007BFF" stroke-width="4"/>
                    <polygon points="850,150 840,145 840,155" fill="#007BFF"/>
                </g>
                
                <!-- Stage 4: Matrix -->
                <g class="pipeline-stage" data-stage="matrix">
                    <rect x="870" y="80" width="220" height="140" rx="12" fill="url(#stageGradient2)" stroke="#001F3F" stroke-width="3" filter="url(#stageShadow)"/>
                    <rect x="870" y="80" width="220" height="8" rx="12" fill="url(#redAccent)"/>
                    <text x="980" y="115" text-anchor="middle" font-size="18" font-weight="700" fill="#001F3F">Priority Matrix</text>
                    <text x="980" y="145" text-anchor="middle" font-size="12" fill="#495057">Action Priorities</text>
                    <text x="980" y="165" text-anchor="middle" font-size="12" fill="#495057">Dashboard Updates</text>
                    <text x="980" y="185" text-anchor="middle" font-size="12" fill="#495057">Alert Generation</text>
                    <text x="980" y="205" text-anchor="middle" font-size="12" fill="#495057">Report Distribution</text>
                    <circle cx="980" cy="55" r="20" fill="#007BFF" opacity="0.1"/>
                    <text x="980" y="62" text-anchor="middle" font-size="20" fill="#007BFF">üìã</text>
                </g>
                
                <!-- Data flow indicator -->
                <text x="600" y="270" text-anchor="middle" font-size="14" font-weight="600" fill="#6c757d" opacity="0.7">
                    <tspan x="600">‚Üê Continuous Data Flow ‚Üí</tspan>
                </text>
            </svg>
        </div>
        
        <div class="pipeline-legend" style="margin-top: 2rem; padding: 1rem; background: #f8f9fa; border-radius: 8px; border-left: 4px solid var(--nuview-blue);">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                <div>
                    <strong style="color: var(--nuview-navy);">üîÑ Real-time Updates:</strong>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; color: #666;">Automated daily data collection from multiple sources</p>
                </div>
                <div>
                    <strong style="color: var(--nuview-navy);">ü§ñ Smart Processing:</strong>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; color: #666;">AI-powered analysis and categorization</p>
                </div>
                <div>
                    <strong style="color: var(--nuview-navy);">üéØ Prioritization:</strong>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; color: #666;">Strategic scoring based on value, urgency, and fit</p>
                </div>
                <div>
                    <strong style="color: var(--nuview-navy);">üìä Actionable Insights:</strong>
                    <p style="margin: 0.25rem 0 0 0; font-size: 0.9rem; color: #666;">Clear next steps and deadline tracking</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Global Search -->
    <div class="search-container">
        <input 
            type="text" 
            id="globalSearch" 
            class="search-input" 
            placeholder="üîç Search programs by title, agency, category, or action..."
        >
    </div>

    <div id="overview" class="section">
        <h2><i class="bi bi-house-door"></i> Executive Overview</h2>
        <p>The global LiDAR market is projected to reach <strong id="market-val">$14.13B</strong> by 2034 (CAGR <span id="market-cagr">19.43%</span>). NUVIEW dominates DaaS with space-based data.</p>
        <div class="row">
            <div class="col-md-3">
                <div class="card text-center">
                    <h3 id="total-programs">0</h3>
                    <p class="text-muted">Total Programs</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <h3 id="total-value">$0</h3>
                    <p class="text-muted">Total Value</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <h3 id="urgent-programs">0</h3>
                    <p class="text-muted">Urgent Actions</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <h3 id="last-updated">Loading...</h3>
                    <p class="text-muted">Last Updated</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Top 10 Opportunity Matrix -->
    <div id="top-opportunities" class="section">
        <h2><i class="bi bi-trophy"></i> Top 10 Opportunity Matrix</h2>
        <p style="color: var(--nuview-dark-gray); margin-bottom: 1.5rem;">
            Highest-value opportunities ranked by strategic importance and urgency
        </p>
        <div style="overflow-x: auto;">
            <table class="matrix-table" role="table" aria-label="Top 10 opportunities matrix">
                <thead>
                    <tr>
                        <th class="matrix-rank" scope="col">#</th>
                        <th scope="col">Opportunity</th>
                        <th scope="col">Agency <span class="matrix-source-badge" role="note" aria-label="Clickable agency links">Link</span></th>
                        <th scope="col">Category</th>
                        <th scope="col">Value</th>
                        <th scope="col">Deadline</th>
                        <th scope="col">Urgency</th>
                        <th scope="col">Next Action</th>
                        <th class="matrix-link" scope="col">Opp Link</th>
                        <th class="matrix-link" scope="col">Budget Source</th>
                    </tr>
                </thead>
                <tbody id="top-opportunities-body">
                    <tr>
                        <!-- Colspan must match total number of columns in table header (10 columns) -->
                        <td colspan="10" style="text-align: center; padding: 2rem; color: var(--nuview-gray);">
                            Loading top opportunities...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="funding" class="section">
        <h2><i class="bi bi-currency-dollar"></i> Funding Opportunities</h2>
        <div id="funding-programs">
            <p>Loading funding programs...</p>
        </div>
    </div>

    <div id="lidar" class="section">
        <h2><i class="bi bi-radar"></i> LiDAR Programs</h2>
        <div id="lidar-programs">
            <p>Loading LiDAR programs...</p>
        </div>
    </div>

    <div id="space-systems" class="section">
        <h2><i class="bi bi-rocket-takeoff"></i> Space Systems</h2>
        <div id="space-systems-programs">
            <p>Loading space systems programs...</p>
        </div>
    </div>

    <div id="platform" class="section">
        <h2><i class="bi bi-server"></i> Platform Initiatives</h2>
        <div id="platform-programs">
            <p>Loading platform programs...</p>
        </div>
    </div>
</main>

<script>
// Global data
let programsData = null;

// Format currency
function formatCurrency(amount) {
    if (!amount) return '$0';
    if (amount >= 1000000000) {
        return '$' + (amount / 1000000000).toFixed(2) + 'B';
    } else if (amount >= 1000000) {
        return '$' + (amount / 1000000).toFixed(1) + 'M';
    } else if (amount >= 1000) {
        return '$' + (amount / 1000).toFixed(0) + 'K';
    }
    return '$' + amount.toFixed(0);
}

// Get urgency badge
function getUrgencyBadge(urgency) {
    const badges = {
        'urgent': '<span class="urgency-badge urgency-urgent" role="status" aria-label="Urgent priority">URGENT</span>',
        'near': '<span class="urgency-badge urgency-near" role="status" aria-label="Near-term priority">NEAR</span>',
        'future': '<span class="urgency-badge urgency-future" role="status" aria-label="Future priority">FUTURE</span>'
    };
    return badges[urgency || 'future'] || badges['future'];
}

// Render Top 10 Opportunities Matrix
function renderTopOpportunities() {
    if (!programsData || !programsData.programs) return;
    
    const allPrograms = [
        ...(programsData.programs.funding || []),
        ...(programsData.programs.lidar || []),
        ...(programsData.programs.spaceSystems || []),
        ...(programsData.programs.platform || [])
    ];
    
    // Remove duplicates by ID
    const uniquePrograms = Array.from(new Map(allPrograms.map(p => [p.id, p])).values());
    
    // Sort by value (descending) and urgency (urgent first)
    const sortedPrograms = uniquePrograms.sort((a, b) => {
        // Prioritize urgent items
        if (a.urgency === 'urgent' && b.urgency !== 'urgent') return -1;
        if (a.urgency !== 'urgent' && b.urgency === 'urgent') return 1;
        // Then sort by value
        return (b.valueUSD || 0) - (a.valueUSD || 0);
    });
    
    // Take top 10
    const top10 = sortedPrograms.slice(0, 10);
    
    const tbody = document.getElementById('top-opportunities-body');
    if (!tbody) return;
    
    tbody.innerHTML = '';
    
    if (top10.length === 0) {
        // Colspan must match total number of columns in table header (10 columns)
        tbody.innerHTML = '<tr><td colspan="10" style="text-align: center; padding: 2rem; color: var(--nuview-gray);">No opportunities available.</td></tr>';
        return;
    }
    
    top10.forEach((program, index) => {
        const row = document.createElement('tr');
        row.setAttribute('role', 'row');
        row.innerHTML = `
            <td class="matrix-rank" role="cell">${index + 1}</td>
            <td role="cell"><strong>${program.title || 'Untitled Program'}</strong></td>
            <td role="cell">
                ${program.agencyLink ? `
                <a href="${program.agencyLink}" target="_blank" rel="noopener noreferrer" 
                   style="color: var(--nuview-navy); text-decoration: underline;"
                   title="Visit ${program.agency || 'agency'} website">
                    ${program.agency || 'N/A'}
                </a>
                ` : program.agency || 'N/A'}
                <span class="matrix-source-badge" role="note" aria-label="Source type">${program.pillar || 'N/A'}</span>
            </td>
            <td role="cell">${program.category || 'N/A'}</td>
            <td class="matrix-value" role="cell">${formatCurrency(program.valueUSD || 0)}</td>
            <td role="cell">${program.deadline || 'TBD'} <small class="text-muted">(${program.daysUntil !== undefined ? program.daysUntil : 'N/A'} days)</small></td>
            <td role="cell">${getUrgencyBadge(program.urgency)}</td>
            <td role="cell" style="color: var(--nuview-red); font-weight: 600;">${program.nextAction || 'No action specified'}</td>
            <td class="matrix-link" role="cell">
                ${program.link && program.link !== '#' ? `
                <a href="${program.link}" target="_blank" rel="noopener noreferrer" 
                   class="matrix-link-btn" 
                   aria-label="View ${program.title || 'program'} opportunity"
                   tabindex="0">
                    View <i class="bi bi-box-arrow-up-right"></i>
                </a>
                ` : `
                <span class="matrix-link-btn" style="opacity: 0.5; cursor: not-allowed;" 
                      aria-label="Link not available"
                      tabindex="-1">
                    N/A
                </span>
                `}
            </td>
            <td class="matrix-link" role="cell">
                ${program.budgetSourceLink && program.budgetSourceLink !== '#' ? `
                <a href="${program.budgetSourceLink}" target="_blank" rel="noopener noreferrer" 
                   class="matrix-link-btn" 
                   aria-label="View budget source for ${program.title || 'program'}"
                   tabindex="0">
                    Budget <i class="bi bi-box-arrow-up-right"></i>
                </a>
                ` : `
                <span class="matrix-link-btn" style="opacity: 0.5; cursor: not-allowed;" 
                      aria-label="Budget source not available"
                      tabindex="-1">
                    N/A
                </span>
                `}
            </td>
        `;
        tbody.appendChild(row);
    });
}

// Create program card
function createProgramCard(program) {
    const card = document.createElement('div');
    card.className = 'program-card';
    card.setAttribute('data-searchable', `${program.title || ''} ${program.agency || ''} ${program.category || ''} ${program.nextAction || ''}`.toLowerCase());
    
    const title = program.title || 'Untitled Program';
    const agency = program.agency || 'N/A';
    const agencyLink = program.agencyLink || '#';
    const value = formatCurrency(program.valueUSD || 0);
    const deadline = program.deadline || 'TBD';
    const daysUntil = program.daysUntil !== undefined ? program.daysUntil : 'N/A';
    const urgency = program.urgency || 'future';
    const nextAction = program.nextAction || 'No action specified';
    const description = program.description || 'No description available';
    const link = program.link || '#';
    const budgetSourceLink = program.budgetSourceLink || '#';
    
    card.innerHTML = `
        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
            <div>
                <h5 style="margin: 0; color: var(--nuview-navy);">${title}</h5>
                <p style="margin: 0.25rem 0; color: #666; font-size: 0.9rem;">${description}</p>
            </div>
            ${getUrgencyBadge(urgency)}
        </div>
        <div class="row" style="margin-top: 1rem; font-size: 0.9rem;">
            <div class="col-md-3">
                <strong>Agency:</strong> ${agencyLink !== '#' ? `<a href="${agencyLink}" target="_blank" style="color: var(--nuview-navy); text-decoration: underline;" title="Visit agency website">${agency}</a>` : agency}
            </div>
            <div class="col-md-3">
                <strong>Value:</strong> ${value}
            </div>
            <div class="col-md-3">
                <strong>Deadline:</strong> ${deadline} (${daysUntil} days)
            </div>
            <div class="col-md-3">
                <strong>Opp:</strong> <a href="${link}" target="_blank" style="color: var(--nuview-red); font-weight: 600;" title="View opportunity">View</a>
                ${budgetSourceLink !== '#' ? ` | <strong>Budget:</strong> <a href="${budgetSourceLink}" target="_blank" style="color: var(--nuview-red); font-weight: 600;" title="View budget source">Source</a>` : ''}
            </div>
        </div>
        <div style="margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid #eee;">
            <strong style="color: var(--nuview-red);">Next Action:</strong> ${nextAction}
        </div>
    `;
    
    return card;
}

// Render programs in a section
function renderPrograms(programs, containerId) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    container.innerHTML = '';
    
    if (!programs || programs.length === 0) {
        container.innerHTML = '<p style="color: #999;">No programs in this category.</p>';
        return;
    }
    
    programs.forEach(program => {
        container.appendChild(createProgramCard(program));
    });
}

// Update overview statistics
function updateOverview() {
    if (!programsData || !programsData.programs) return;
    
    const allPrograms = [
        ...(programsData.programs.funding || []),
        ...(programsData.programs.lidar || []),
        ...(programsData.programs.spaceSystems || []),
        ...(programsData.programs.platform || [])
    ];
    
    // Remove duplicates by ID
    const uniquePrograms = Array.from(new Map(allPrograms.map(p => [p.id, p])).values());
    
    const totalValue = uniquePrograms.reduce((sum, p) => sum + (p.valueUSD || 0), 0);
    const urgentCount = uniquePrograms.filter(p => p.urgency === 'urgent').length;
    
    document.getElementById('total-programs').textContent = uniquePrograms.length;
    document.getElementById('total-value').textContent = formatCurrency(totalValue);
    document.getElementById('urgent-programs').textContent = urgentCount;
    
    if (programsData.meta && programsData.meta.updated) {
        const date = new Date(programsData.meta.updated);
        document.getElementById('last-updated').textContent = date.toLocaleDateString();
    }
}

// Global search functionality - FIX: use e.target.value instead of this.value
function setupGlobalSearch() {
    const searchInput = document.getElementById('globalSearch');
    if (!searchInput) return;
    
    searchInput.addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase(); // FIXED: use e.target.value
        const allCards = document.querySelectorAll('.program-card');
        
        allCards.forEach(card => {
            const searchableText = card.getAttribute('data-searchable') || '';
            if (searchableText.includes(searchTerm)) {
                card.classList.remove('hidden');
            } else {
                card.classList.add('hidden');
            }
        });
    });
}

// Format deadline display
function formatDeadlineDisplay(deadline, daysUntil) {
    const deadlineStr = deadline || 'TBD';
    const daysStr = daysUntil !== undefined && daysUntil !== null ? daysUntil : 'N/A';
    return `${deadlineStr} (${daysStr} days)`;
}

// Render Launched Opportunities Box
function renderLaunchedOpps() {
    if (!programsData || !programsData.programs) return;
    
    const allPrograms = [
        ...(programsData.programs.funding || []),
        ...(programsData.programs.lidar || []),
        ...(programsData.programs.spaceSystems || []),
        ...(programsData.programs.platform || [])
    ];
    
    // Remove duplicates by ID
    const uniquePrograms = Array.from(new Map(allPrograms.map(p => [p.id, p])).values());
    
    // Filter for launched opportunities (those with daysUntil < 0 or status indicating launched)
    // For demo purposes, we'll show the most recent/urgent opportunities
    const launchedOpps = uniquePrograms
        .filter(p => p.urgency === 'urgent' || (p.daysUntil !== undefined && p.daysUntil !== null && p.daysUntil <= 30))
        .sort((a, b) => {
            const aDays = a.daysUntil ?? 999;
            const bDays = b.daysUntil ?? 999;
            return aDays - bDays;
        })
        .slice(0, 5);
    
    const container = document.getElementById('launched-opps-container');
    if (!container) return;
    
    if (launchedOpps.length === 0) {
        container.innerHTML = '<div class="launched-opps-empty">No recent launches</div>';
        return;
    }
    
    container.innerHTML = '';
    launchedOpps.forEach(opp => {
        const item = document.createElement('div');
        item.className = 'launched-opp-item';
        item.innerHTML = `
            <h4>${opp.title || 'Untitled'}</h4>
            <p><strong>Agency:</strong> ${opp.agency || 'N/A'}</p>
            <p><strong>Value:</strong> <span class="launched-opp-value">${formatCurrency(opp.valueUSD || 0)}</span></p>
            <p><strong>Deadline:</strong> ${formatDeadlineDisplay(opp.deadline, opp.daysUntil)}</p>
            ${opp.link && opp.link !== '#' ? `
            <p><a href="${opp.link}" target="_blank" rel="noopener noreferrer" class="launched-opp-link">View Details ‚Üí</a></p>
            ` : ''}
        `;
        container.appendChild(item);
    });
}


// Load programs data
async function loadPrograms() {
    try {
        const response = await fetch('../data/processed/programs.json');
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        programsData = await response.json();
        
        // Render top 10 opportunities matrix
        renderTopOpportunities();
        
        // Render launched opportunities box
        renderLaunchedOpps();
        
        // Render all sections with robust handling for missing data
        renderPrograms(programsData.programs?.funding || [], 'funding-programs');
        renderPrograms(programsData.programs?.lidar || [], 'lidar-programs');
        renderPrograms(programsData.programs?.spaceSystems || [], 'space-systems-programs');
        renderPrograms(programsData.programs?.platform || [], 'platform-programs');
        
        // Update overview
        updateOverview();
        
        // Setup global search
        setupGlobalSearch();
        
    } catch (error) {
        console.error('Error loading programs data:', error);
        const containers = ['funding-programs', 'lidar-programs', 'space-systems-programs', 'platform-programs'];
        containers.forEach(id => {
            const container = document.getElementById(id);
            if (container) {
                container.innerHTML = '<p style="color: var(--nuview-red);">Error loading data. Please check the console for details.</p>';
            }
        });
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    loadPrograms();
    initializePipelineTooltips();
});

// Pipeline stage tooltips
function initializePipelineTooltips() {
    // Tooltip positioning constants
    const TOOLTIP_HORIZONTAL_OFFSET = 140; // Half tooltip width for centering
    const TOOLTIP_VERTICAL_OFFSET = 15; // Gap between tooltip and element
    
    const tooltipData = {
        sources: {
            title: 'Data Sources',
            description: 'We aggregate opportunities from federal contract databases (SAM.gov), NASA ROSES, research grants, and industry reports. Automated scrapers collect data daily to ensure comprehensive coverage.'
        },
        engine: {
            title: 'Processing Engine',
            description: 'Our engine normalizes data from various formats, matches duplicate entries across sources, and enriches records with additional context. This ensures clean, consistent data for analysis.'
        },
        scoring: {
            title: 'Scoring System',
            description: 'Each opportunity receives scores for financial value, strategic alignment with NUVIEW capabilities, deadline urgency, and execution risk. These scores drive prioritization and action planning.'
        },
        matrix: {
            title: 'Priority Matrix',
            description: 'High-scoring opportunities are organized into the priority matrix, generating alerts for urgent actions, updating dashboards in real-time, and distributing reports to stakeholders.'
        }
    };
    
    // Create tooltip element
    const tooltip = document.createElement('div');
    tooltip.className = 'pipeline-tooltip';
    document.body.appendChild(tooltip);
    
    // Add event listeners to pipeline stages
    const stages = document.querySelectorAll('.pipeline-stage');
    stages.forEach(stage => {
        stage.addEventListener('mouseenter', function(e) {
            const stageType = this.getAttribute('data-stage');
            const data = tooltipData[stageType];
            
            if (data) {
                tooltip.innerHTML = `<strong style="color: var(--nuview-red);">${data.title}</strong><br><span style="color: #e9ecef;">${data.description}</span>`;
                tooltip.classList.add('show');
            }
        });
        
        stage.addEventListener('mousemove', function(e) {
            const rect = this.getBoundingClientRect();
            tooltip.style.left = (e.clientX - TOOLTIP_HORIZONTAL_OFFSET) + 'px';
            tooltip.style.top = (rect.top - tooltip.offsetHeight - TOOLTIP_VERTICAL_OFFSET + window.scrollY) + 'px';
        });
        
        stage.addEventListener('mouseleave', function() {
            tooltip.classList.remove('show');
        });
    });
}
</script>
</body>
</html>
